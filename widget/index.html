<!doctype html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0"/>
    <title>主页</title>
    <link rel="stylesheet" type="text/css" href="./css/api.css"/>
    <link rel="stylesheet" type="text/css" href="./css/style.css"/>
    <style>
        header{
            background-color: #f2f2f2;
            position: relative;
        }
        .top-button{
            margin: 0 1em;
            text-align: center;
            height: 50px;
            line-height: 50px;
            font-size: 16px;
        }
        .fl{
            float: left;
        }
        .fr {
            float: right;
        }
    </style>
</head>
<body>
<div id="wrap" class="flex-wrap flex-vertical">
    <header>
        <div class='top-button fl' >
            <a href="" tapmode="presshover" onclick="openWin('option')">设置</a>
        </div>
        <div class='top-button fr' >
            <a href="" tapmode="presshover" onclick="openWin('search')">查找</a>
        </div>
        <div class='top-button fr' >
            <a href="" tapmode="presshover" onclick="openWin('newhis')">新增</a>
        </div>
    </header>
    <div id="main" class="flex-con">

    </div>
</div>
</body>
</html>
<script type="text/javascript" src="script/api.js"></script>
<script type="text/javascript">
    apiready = function () {
        $api.fixStatusBar( $api.dom('header') );
        var listView = api.require('listView');
        listView.open({
            "x": 0,
            "y": $api.dom('header').offsetHeight,
            "w": api.winWidth,
            "h": $api.dom('#main').offsetHeight,
            "leftBtn": [
                {
                    "color": "#E76B65",
                    "selectColor": "#bc534d",
                    "title": "修改"
                }, {
                    "color": "#E76B65",
                    "selectColor": "#bc534d",
                    "title": "删除"
                }
            ],
            "leftBg": "#e9e9e9",
            "borderColor": "#CCCCCC",
            "cellBgColor": "#F0F5F5",
            "cellSelectColor": "#E9E9E9",
            "data":[
                {   
                    "placeHoldImg": "./image/bottombtn0101.png",
                    "title": "患者甲",
                    "titleLocation": "left",
                    "titleSize": "16",
                    "titleColor": "#999999",
                    "subTitle": "白内障",
                    "subLocation": "left",
                    "subTitleSize": "14",
                    "subTitleColor": "#999999"
                }, {
                    "placeHoldImg": "./image/bottombtn0201.png",
                    "title": "患者乙",
                    "titleLocation": "left",
                    "titleSize": "16",
                    "titleColor": "#999999",
                    "subTitle": "青光眼",
                    "subLocation": "left",
                    "subTitleSize": "14",
                    "subTitleColor": "#999999"
                }
            ],
            fixedOn: api.frameName
        },
        function(ret, err) {
            var msg;

            if(0 == ret.clickType){
                msg = "您点击了第 " + ret.index +" 个单元格";
            }

            if(1 == ret.clickType){
                msg += " 右边第 " + ret.btnIndex + " 个按钮";
            }

            if(2 == ret.clickType){
                msg += " 左边第 " + ret.btnIndex + " 个按钮";
            }

            api.toast({
                msg: msg,
                duration: 1000,
                location: "top"
            });
        });

        listView.setRefreshHeader({
                bgColor: "#f5f5f5",
                loadingImg : "./image/bottombtn0301.png"
            }, 
            function(ret,err){
                /* 触发加载事件, 此处应使用使用 reloadData 方法.*/
                listView.reloadData({
                    data:[
                        {
                            "placeHoldImg":"./image/bottombtn0301.png",
                            "title":"新标题1",
                            "subTitle":"新子标题1"
                        },
                        {
                            "placeHoldImg":"./image/bottombtn0401.png",
                            "title":"新标题2",
                            "subTitle":"新子标题2"
                        }]
                }
            );

        });

        listView.setRefreshFooter({
                bgColor: "#f5f5f5",
                loadingImg : "./image/bottombtn0301.png"
            },
            function(ret,err){
                /* 触发加载事件, 此处应使用使用 appendData 方法.*/
                listView.appendData({
                    data:[
                        {
                            "placeHoldImg":"./image/bottombtn0301.png",
                            "title":"新标题3",
                            "subTitle":"新子标题3"
                        },
                        {
                            "placeHoldImg":"./image/bottombtn0401.png",
                            "title":"新标题4",
                            "subTitle":"新子标题4"
                        }]
                }
            );
        });
    }

    function openWin(type) {
        api.openWin({
            name: type,
            url: './html/' + type + '.html',
            pageParam: {},
            bounces: false,
            opaque: false
        });
    }
</script>